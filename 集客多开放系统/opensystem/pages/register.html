<html lang="zh-CN">
	<head>
		<meta charset="UTF-8">
		<title>注册</title>
		<link rel="icon" href="../img/titleLogo.png" type="image/x-icon"/>
		<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
		<meta http-equiv="X-UA-Compatible" content="IE=11;IE=10;IE=9;IE=8;IE=edge,chrome=1">
		<meta http-equiv="Cache-Control" content="no-siteapp">
		<meta name="keywords" content="">
		<meta name="description" content="">
		<script src="../js/jquery.min.js" type="text/javascript"></script>
		<script src="../js/util.js" type="text/javascript"></script>
		<link href="../css/bootstrap.css" rel="stylesheet" />
		<link href="../css/login.css" rel="stylesheet" />
		<link href="../css/register.css" rel="stylesheet" />
		<link href="../css/main.css" rel="stylesheet" />
	</head>
	<body>
		<div class="containers">
		  	<div class="top">
  				<img src="../icon/yz.png" class="top_log"  id="logoImage"/>
  				<img src="../icon/txtyz.png" class="top_txt" />
  				<span class="top_span">注册</span>
  				<div class="top_zc" id="top_login">
  					已有账号，立即登录
  				</div>
  			</div>
  			<div class="progress_top">
  				<ul>
  					<li><span class="on">1</span><p class="oncor" style="right: 10px;">创建账户</p><label class="on"></label></li>
  					<li><span>2</span><p style="right: 25px;">设置身份信息</p><label></label></li>
  					<li><span>3</span><p style="left: 5px;">成功</p></li>
  				</ul>
  			</div>
  			<div class="contents">
  				<div class="chose">
  					<div class="cho_left cho on">
  						<img src="../icon/gr-1.png" />
  						<span class="bai">个人账户</span>
  						<label></label>
  					</div>
  					<div class="cho_right cho">
  						<img src="../icon/xx-2.png" />
  						<span>公司账户</span>
  						<label class="none"></label>
  					</div>
  				</div>
  				<div class="busi none">
	  				<ul>
	  					<li>
	  						<span class="c_span">国籍/地区</span>
	  						<select class="gj_sect" id="country_busi">
							  <option value ="86" >中国</option>
							  <option value ="87" >澳大利亚</option>
							</select>
	  					</li>
	  					<li>
	  						<span class="c_span">手机号码</span>
	  						<select id="countryCode_busi">
							  <option value ="86">+86</option>
							  <option value ="87">+87</option>
							</select>
							<input type="text" placeholder="请输入你的手机号码" id="phone_busi" class="phone_ipt c_ipt"/>
	  					</li>
	  					<li>
	  						<span class="c_span">短信验证码</span>
	  						<input type="text" placeholder="请输入验证码"  id="code_busi" class="c_ipt yzm_ipt"/>
	  						<button class="yzm_btn mucor" onclick="getCode(this,'phone_busi')">获取验证码</button>
	  					</li>
	  				</ul>
	  				<div class="dl">
	  					<input type="checkbox" name="checkbox1" id="checkBox_busi" value="checkbox"> 同意《平台协议》
	  				</div>
	  				<a href="#"><div class="fot_btn">
	  					<button class="mu" onclick="nextRegister('busi')">下一步</button>
	  				</div></a>
  				</div>
  				<div class="men">
	  				<ul>
	  					<li>
	  						<span class="c_span">国籍/地区</span>
	  						<select class="gj_sect" id="country_men">
							  <option value ="86" >中国</option>
							  <option value ="87">澳大利亚</option>
							</select>
	  					</li>
	  					<li>
	  						<span class="c_span">手机号码</span>
	  						<select id="countryCode_men">
							  <option value ="86">+86</option>
							  <option value ="87">+87</option>
							</select>
							<input type="text" placeholder="请输入你的手机号码"  id="phone_men" class="phone_ipt c_ipt"/>
	  					</li>
	  					<li>
	  						<span class="c_span">短信验证码</span>
	  						<input type="text" placeholder="请输入验证码"  id="code_men" class="c_ipt yzm_ipt"/>
	  						<button class="yzm_btn" onclick="getCode(this,'phone_men')">获取验证码</button>
	  					</li>
	  				</ul>
	  				<div class="dl">
	  					<input type="checkbox" name="checkbox1" id="checkBox_men"  value="checkbox"> 同意《平台协议》
	  				</div>
	  				<a href="#"><div class="fot_btn">
	  					<button onclick="nextRegister('men')">下一步</button>
	  				</div></a>
  				</div>
  			</div>
  			<div class="foot">
  				<span>©</span><span>上海御馔网络科技有限公司</span>
  			</div>
		</div>
	</body>

	<script>
        $("#logoImage").click(function(){
            //点击图片后发送跳转到指定页面的事件。
            window.location.href="Home.html";
        });
		var businssType = 1;
		$(function(){
			$('.cho_left').click(function(){
				$('.cho_left').addClass('on').find('span').addClass('bai');
				$('.cho_right').removeClass('mu').find('span').removeClass('bai');
				$('.cho_right label').hide();
				$('.cho_left label').show();
				$('.cho_right img').attr('src', '../icon/xx-2.png');
				$('.cho_left img').attr('src', '../icon/gr-1.png');
				$('.men').show();
				$('.busi').hide();
				$('.top_zc').removeClass('mucor').addClass('oncor');
				$('.progress_top span:first').removeClass('mu').addClass('on');
				$('.progress_top label:first').removeClass('mu').addClass('on');
				$('.progress_top p:first').removeClass('mucor').addClass('oncor');
			})
			$('.cho_right').click(function(){
                businssType = 2;
				$('.cho_right').addClass('mu').find('span').addClass('bai');
				$('.cho_left').removeClass('on').find('span').removeClass('bai');
				$('.cho_left label').hide();
				$('.cho_right label').show();
				$('.cho_right img').attr('src', '../icon/xx.png');
				$('.cho_left img').attr('src', '../icon/gr-(2).png');
				$('.busi').show();
				$('.men').hide();
				$('.progress_top span:first').removeClass('on').addClass('mu');
				$('.progress_top label:first').removeClass('on').addClass('mu');
				$('.progress_top p:first').removeClass('oncor').addClass('mucor');
				$('.top_zc').removeClass('oncor').addClass('mucor');
			})
			$("#top_login").click(function () {
				window.location.href ="login.html";
			});
			$("#country_men").change(function() {
				var selectValue = $("#country_men").val();
				SelectChange("#countryCode_men",selectValue);
			});
			$("#country_busi").change(function() {
				var selectValue = $("#country_busi").val();
				SelectChange("#countryCode_busi",selectValue);
			});

		});
		function SelectChange(countryCodeId,selectValue){
			$(countryCodeId + " option").each(function () {

				if($(this).val() == selectValue) {
					$(this).attr("selected",true);
				}else{
					$(this).attr("selected",false);
				}
			})
		}
        function checkPhone(phone){
           if(!(/^1(3|4|5|7|8)\d{9}$/.test(phone))){
                return false;
            }
            return true;
        }
        var timestamp=0;

		function getCode(obj,id) {
			var htmlId ="#"+id;
			var phoneValue = $(htmlId).val();
			var data = {};

			if (!phoneValue || phoneValue==""){
				$.openTxt.info("手机号不能为空",1000);
				return false;
			}else{
			    if(!checkPhone(phoneValue)){
                    $.openTxt.info("请输入有效手机号",1000);
                    return false;
				}
			}
            if(!isSend){
                $.openTxt.info("倒计时结束后才可以重新发送验证码",1000);
                return false;

            }
			data.phone = phoneValue;
			sendAjax.get(util.baseURL + "user/getPhoneValidateCode",data,function (msg) {
				if (msg.retCode=="1"){
					countdown(obj);
				}else{
					$.openTxt.info(msg.msg,1000)
				}
			});
		}
		var isSend=true;
		function countdown(obj) {
			var i = 120;
			$(obj).html("120s");
			time = setInterval(function () {
				if (i == 0) {
					clearInterval(time);
					$(obj).html("重新发送");
					mark = true;
					i = 120;
				}
				else {
                    isSend = false;
					i--;
					mark = false;
					$(obj).html(i+"s");
				}
			}, 1000);
		}
		function nextRegister(flag) {
			var phoneId = "#phone_"+flag;
			var codeId = "#code_"+flag;
			var checkBoxId = "#checkBox_"+flag;
			var data = {};
			var phoneValue = $(phoneId).val();
			var codeValue = $(codeId).val();
			var checkBoxValue = $(checkBoxId).is(':checked');
            if (!phoneValue || phoneValue==""){
                $.openTxt.info("手机号不能为空",1000);
                return false;
            }else{
                if(!checkPhone(phoneValue)){
                    $.openTxt.info("请输入有效手机号",1000);
                    return false;
                }
            }
			if (!codeValue || codeValue ==""){
				$.openTxt.info("请输入有效验证码",1000);
                return false;
			}
			if (!checkBoxValue ){
				$.openTxt.info("请阅读协议且同意",1000);
                return false;
			}
			data.code = codeValue;
			data.phone = phoneValue;
			sendAjax.post(util.baseURL + "user/checkPhoneValidateCode",JSON.stringify(data),function (msg) {
				if (msg.retCode=="1"){
					var htmlVal =  "register_" + flag + ".html?phone="+phoneValue;
                    commFun.saveData("phone",phoneValue);
					window.location.href = htmlVal;
				}else{
					$.openTxt.info(msg.msg,2000)
				}
			})
		}

	</script>
</html>
